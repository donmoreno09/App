# ðŸ—ï¸ Deployment & Installer Creation (Windows)

[[_TOC_]]

This section explains how to configure, build, install, and package the application using **CMake**, **Ninja**, and **CPack** on Windows.

Make sure you have **NSIS** installed and added to your system **PATH**.
Download it here: [https://nsis.sourceforge.io/Download](https://nsis.sourceforge.io/Download)

NSIS is used to generate Windows installers.

## Deployment

### 0. Prepare the environment

1. Press the Windows key and search for **x64 Native Tools for VS 2022** to open the developer command prompt.

2. Run:

    ```bash
    C:\Qt\6.8.3\msvc2022_64\bin\qtenv2.bat
    ```

    This sets the environment variables required for Qt tools.

    > You can safely ignore the warning `Remember to call vcvarsall.bat to complete environment setup!` if it appears.

3. Move into the projectâ€™s repository.

### 1. Configure the project

Run CMake to configure the build and set up Qt paths:

```bash
cmake -S . -B build -G "Ninja Multi-Config" ^
  -DCMAKE_BUILD_TYPE=Release ^
  -DCMAKE_TOOLCHAIN_FILE="C:\Qt\6.8.3\msvc2022_64\lib\cmake\Qt6\qt.toolchain.cmake" ^
  -DCMAKE_PREFIX_PATH="C:\Qt\6.8.3\msvc2022_64;C:\Qt\6.8.3\msvc2022_64\maplibre-native-qt\install" ^
  -DCMAKE_INSTALL_PREFIX=".\install"
```

> If MapLibre is installed elsewhere, update the path inside `DCMAKE_PREFIX_PATH` accordingly.

## 2. Build the application

```bash
cmake --build build --config Release
```

## 3. Install the built files

```bash
cmake --install build --config Release
```

## 4. Generate the installer

Run this inside the **build/** directory:

```bash
cpack -C Release
```

This generates an installer (`.exe`) inside **build/**, ready for distribution.

## Installation, Setup, and Running

> Because we currently do not have a fixed backend URL, please follow these installation steps carefully.

After generating the installer, run it and follow the wizard. One of the steps allows you to choose where shortcuts will be created.

Once installed, go to the application folder which by default:

```
C:\Program Files\IRIDESS_FE
```

Open the `bin/` directory and run `IRIDESS_FE.exe` **as administrator**. After it starts, close it: this ensures that `config.ini` is generated inside `bin/`.

Open `config.ini` **as administrator** (required because itâ€™s inside `C:\Program Files`). The file looks like this:

```ini
[mqtt]
host=0.tcp.eu.ngrok.io
port=10290

[rest]
; Base URL of the REST API (no trailing slash!)
baseUrl=https://trusted-wahoo-smooth.ngrok-free.app
```

These values are generated by **ngrok**, which forwards requests to the backend running inside Docker in the VDI.

Set up ngrok inside the VDI while the backend is running to obtain your own host and port values. After updating and saving `config.ini`, reopen `IRIDESS_FE.exe`. You should now be able to use all features, including PoI saving, naval track viewing, and more.
